\begin{minted}[xleftmargin=\parindent,linenos]{c}
    void esp_mesh_external_rx(void *arg){
       struct sockaddr_in src;
       socklen_t sockLen;
   
       mesh_addr_t mesh_dest_addr;
       mesh_data_t mesh_data;
       mesh_data.proto = MESH_PROTO_BIN;
   
       uint8_t *mac_addr;
       static fd_set readSet;//set of file descriptors
       struct timeval timeout = {.tv_usec = 500000/*in microseconds*/};
       while(is_running){
           FD_ZERO(&readSet);//clear the set
           /*add sockets from the matching table to the set*/
           for(int i=0; i<MATCHING_TABLE_SIZE; i++){
               /*...*/
               currentSock=matching_table[i]->sock;
               FD_SET(currentSock,&readSet);
               /*...*/
           }
           if(select(maxSock+1, &readSet, NULL, NULL, &timeout) < 0){
               ESP_LOGE(TAG, "select error");
               continue;
           }
           /*search for the record that corresponds to the socket that
            *received data
            */
           for(int i=0; i<MATCHING_TABLE_SIZE; i++){
               /*...*/
               sock = matching_table[i]->sock;
               mac_addr = matching_table[i]->addr;  
               if(FD_ISSET(sock, &readSet)){//we found the record
                   recv_value = recvfrom(sock, rx_buf, sizeof(rx_buf), 0,
                       &src, &sockLen);
                   /*...*/
                   mesh_data.size = sizeof(rx_buf);//set mesh data
                   mesh_data.data = rx_buf;
                   memcpy(mesh_dest_addr.addr, mac_addr, 6);//set mesh addr
                   /*send data*/
                   err=esp_mesh_send(&mesh_dest_addr,&mesh_data,
                       MESH_DATA_P2P,NULL,0);
                   /*...*/      
               
               \end{minted}